<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI 生成 PPT</title>
    <meta name="description" content="嵌入 Dify 工作流的 AI 生成 PPT 页面" />
    <style>
      :root { color-scheme: light dark; }
      html, body { height: 100%; margin: 0; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, PingFang SC, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }

      .app {
        position: fixed;
        inset: 0;
        display: grid;
        grid-template-rows: auto 1fr;
        background: Canvas;
      }
      header { padding: 10px 14px; border-bottom: 1px solid rgba(0,0,0,.08); }
      header h1 { margin: 0; font-size: 16px; font-weight: 600; }

      .frame-wrap { position: relative; }
      /* 使用 flex 创建上下分栏 */
      .split {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        min-height: 400px;
      }

      .pane {
        position: relative;
        min-height: 120px;            /* 防止太小 */
        overflow: hidden;
      }
      .pane iframe {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
      }

      /* 分隔条 */
      .divider {
        flex: 0 0 var(--handle-size, 8px);
        cursor: row-resize;
        background:
          repeating-linear-gradient(
            to right,
            color-mix(in oklab, CanvasText 30%, transparent) 0 8px,
            transparent 8px 16px
          );
        border-top: 1px solid rgba(0,0,0,.08);
        border-bottom: 1px solid rgba(0,0,0,.08);
      }

      /* 默认把上面设为 50% 高度 */
      .top   { flex: 0 0 var(--top-size, 50%); }
      .bottom{ flex: 1 1 auto; }

      /* 拖拽中禁用 iframe 鼠标事件，防止捕获指针 */
      .dragging .pane iframe { pointer-events: none; }
    </style>
  </head>
  <body>
    <div class="app">
      <header>
        <h1>AI 生成 PPT</h1>
      </header>

      <div class="frame-wrap">
        <div class="split" id="splitRoot">
          <!-- 上半：原有聊天机器人 -->
          <div class="pane top" id="topPane">
            <iframe
              src="https://dify.661118.xyz/chatbot/8bpAewkJPN1Cynqm"
              allow="microphone"
              title="AI 生成 PPT 聊天机器人"
              loading="eager">
            </iframe>
          </div>

          <!-- 可拖拽分隔条 -->
          <div class="divider"
               id="divider"
               role="separator"
               aria-orientation="horizontal"
               aria-label="拖动调整上下区域大小"
               title="拖动调整大小（双击重置为 50%）">
          </div>

          <!-- 下半：SVG Show -->
          <div class="pane bottom">
            <iframe
              src="https://www.codeinword.com/svgshow"
              title="SVG 展示"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade">
            </iframe>
          </div>
        </div>

        <noscript>
          <div style="padding:16px;font-size:14px;">需要启用 JavaScript 才能加载嵌入内容。</div>
        </noscript>
      </div>
    </div>

    <script>
      (function () {
        const split   = document.getElementById('splitRoot');
        const topPane = document.getElementById('topPane');
        const divider = document.getElementById('divider');

        let startY = 0;
        let startHeight = 0;
        let onMove = null;

        function pctNow() {
          const total = split.clientHeight;
          const handle = divider.getBoundingClientRect().height;
          const topH = topPane.getBoundingClientRect().height;
          return Math.round((topH / (total - handle)) * 100);
        }

        function setTopHeight(px) {
          const total = split.clientHeight;
          const handle = divider.getBoundingClientRect().height;
          const min = 120;                     // 与 CSS 对齐
          const max = total - handle - 120;    // 底部保留最小值
          const clamped = Math.max(min, Math.min(max, px));
          topPane.style.flexBasis = clamped + 'px';
          divider.setAttribute('aria-valuenow', String(pctNow()));
        }

        divider.addEventListener('pointerdown', (e) => {
          e.preventDefault();
          document.body.classList.add('dragging');
          divider.setPointerCapture(e.pointerId);
          startY = e.clientY;
          startHeight = topPane.getBoundingClientRect().height;

          onMove = (ev) => {
            const dy = ev.clientY - startY;
            setTopHeight(startHeight + dy);
          };
          window.addEventListener('pointermove', onMove);
        });

        window.addEventListener('pointerup', () => {
          if (onMove) {
            window.removeEventListener('pointermove', onMove);
            onMove = null;
            document.body.classList.remove('dragging');
          }
        });

        // 双击重置为 50%
        divider.addEventListener('dblclick', () => {
          topPane.style.flexBasis = '50%';
          divider.setAttribute('aria-valuenow', '50');
        });

        // 初次设定 aria 值
        divider.setAttribute('aria-valuemin', '10');
        divider.setAttribute('aria-valuemax', '90');
        divider.setAttribute('aria-valuenow', '50');

        // 窗口尺寸变化时，确保高度不越界
        window.addEventListener('resize', () => {
          const h = topPane.getBoundingClientRect().height;
          setTopHeight(h);
        });
      })();
    </script>
  </body>
</html>





